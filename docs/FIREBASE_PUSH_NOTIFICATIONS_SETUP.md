# üîî –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Push-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –≤ Firebase Console

–ü–æ—à–∞–≥–æ–≤–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ –Ω–∞—Å—Ç—Ä–æ–π–∫–µ Firebase Cloud Messaging (FCM) –¥–ª—è Android –∏ iOS.

## üìã –¢–µ–∫—É—â–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –ø—Ä–æ–µ–∫—Ç–∞

- **Firebase Project ID**: `comguestspotapp`
- **Project Number**: `693188820206`
- **Android Package**: `com.guestspot.app`
- **iOS Bundle ID**: `com.guestspot.app`

## üîß –®–∞–≥ 1: –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π

### 1.1 –û—Ç–∫—Ä–æ–π—Ç–µ Firebase Console
1. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –Ω–∞ https://console.firebase.google.com/
2. –í—ã–±–µ—Ä–∏—Ç–µ –ø—Ä–æ–µ–∫—Ç **comguestspotapp**

### 1.2 –ü—Ä–æ–≤–µ—Ä—å—Ç–µ Android –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
1. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ **‚öôÔ∏è Project settings** (—à–µ—Å—Ç–µ—Ä–µ–Ω–∫–∞ –≤–≤–µ—Ä—Ö—É)
2. –ü—Ä–æ–∫—Ä—É—Ç–∏—Ç–µ –¥–æ —Ä–∞–∑–¥–µ–ª–∞ **Your apps**
3. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ Android –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–æ:
   - **Package name**: `com.guestspot.app`
   - **App ID**: `1:693188820206:android:a73ac7c9b39f05ec8c47ff`
4. –ï—Å–ª–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –Ω–µ—Ç ‚Äî –¥–æ–±–∞–≤—å—Ç–µ –µ–≥–æ:
   - –ù–∞–∂–º–∏—Ç–µ **Add app** ‚Üí **Android**
   - –í–≤–µ–¥–∏—Ç–µ Package name: `com.guestspot.app`
   - –°–∫–∞—á–∞–π—Ç–µ `google-services.json` –∏ –∑–∞–º–µ–Ω–∏—Ç–µ —Ñ–∞–π–ª –≤ `src-capacitor/android/app/`

### 1.3 –ü—Ä–æ–≤–µ—Ä—å—Ç–µ iOS –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
1. –í —Ç–æ–º –∂–µ —Ä–∞–∑–¥–µ–ª–µ **Your apps** –ø—Ä–æ–≤–µ—Ä—å—Ç–µ iOS –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ:
   - **Bundle ID**: `com.guestspot.app`
   - **App ID**: `1:693188820206:ios:23dc5d1d3d9b81d88c47ff`
2. –ï—Å–ª–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –Ω–µ—Ç ‚Äî –¥–æ–±–∞–≤—å—Ç–µ –µ–≥–æ:
   - –ù–∞–∂–º–∏—Ç–µ **Add app** ‚Üí **iOS**
   - –í–≤–µ–¥–∏—Ç–µ Bundle ID: `com.guestspot.app`
   - –°–∫–∞—á–∞–π—Ç–µ `GoogleService-Info.plist` –∏ –∑–∞–º–µ–Ω–∏—Ç–µ —Ñ–∞–π–ª –≤ `src-capacitor/ios/App/App/`

## üîî –®–∞–≥ 2: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Cloud Messaging

### 2.1 –í–∫–ª—é—á–∏—Ç–µ Cloud Messaging API
1. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ **‚öôÔ∏è Project settings** ‚Üí **Cloud Messaging**
2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ Cloud Messaging –≤–∫–ª—é—á–µ–Ω
3. –ï—Å–ª–∏ –Ω–µ –≤–∫–ª—é—á–µ–Ω ‚Äî –Ω–∞–∂–º–∏—Ç–µ **Enable**

### 2.2 –ü–æ–ª—É—á–∏—Ç–µ Server Key (–¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ —Å –±—ç–∫–µ–Ω–¥–∞)
1. –í —Ä–∞–∑–¥–µ–ª–µ **Cloud Messaging** –Ω–∞–π–¥–∏—Ç–µ:
   - **Cloud Messaging API (Legacy)** ‚Äî Server key
   - –ò–ª–∏ —Å–æ–∑–¥–∞–π—Ç–µ **Service Account** (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

#### –í–∞—Ä–∏–∞–Ω—Ç A: Server Key (Legacy)
1. –ù–∞–π–¥–∏—Ç–µ **Server key** –≤ —Ä–∞–∑–¥–µ–ª–µ Cloud Messaging
2. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ –∫–ª—é—á (–Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è —Å `AAAA...`)
3. –°–æ—Ö—Ä–∞–Ω–∏—Ç–µ –µ–≥–æ –Ω–∞ –±—ç–∫–µ–Ω–¥–µ –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π

#### –í–∞—Ä–∏–∞–Ω—Ç B: Service Account (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)
1. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ **‚öôÔ∏è Project settings** ‚Üí **Service accounts**
2. –ù–∞–∂–º–∏—Ç–µ **Generate new private key**
3. –°–∫–∞—á–∞–π—Ç–µ JSON-—Ñ–∞–π–ª —Å –∫–ª—é—á–∞–º–∏
4. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —ç—Ç–æ—Ç —Ñ–∞–π–ª –Ω–∞ –±—ç–∫–µ–Ω–¥–µ (–Ω–∞–ø—Ä–∏–º–µ—Ä, —Å `firebase-admin` SDK)

## üì± –®–∞–≥ 3: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ iOS (APNs)

### 3.1 –ó–∞–≥—Ä—É–∑–∏—Ç–µ APNs —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç/–∫–ª—é—á
–î–ª—è iOS –Ω—É–∂–µ–Ω APNs (Apple Push Notification service) —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç:

1. **–í Firebase Console**:
   - –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ **‚öôÔ∏è Project settings** ‚Üí **Cloud Messaging** ‚Üí **Apple app configuration**
   - –ù–∞–π–¥–∏—Ç–µ —Ä–∞–∑–¥–µ–ª **APNs Authentication Key** –∏–ª–∏ **APNs Certificates**

2. **–°–æ–∑–¥–∞–π—Ç–µ APNs Key –≤ Apple Developer**:
   - –ü–µ—Ä–µ–π–¥–∏—Ç–µ –Ω–∞ https://developer.apple.com/account/resources/authkeys/list
   - –ù–∞–∂–º–∏—Ç–µ **+** –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –Ω–æ–≤–æ–≥–æ –∫–ª—é—á–∞
   - –í—ã–±–µ—Ä–∏—Ç–µ **Apple Push Notifications service (APNs)**
   - –°–∫–∞—á–∞–π—Ç–µ `.p8` —Ñ–∞–π–ª (—Å–æ—Ö—Ä–∞–Ω–∏—Ç–µ Key ID)
   - –ó–∞–≥—Ä—É–∑–∏—Ç–µ –∫–ª—é—á –≤ Firebase Console:
     - **APNs Authentication Key**: –∑–∞–≥—Ä—É–∑–∏—Ç–µ `.p8` —Ñ–∞–π–ª
     - **Key ID**: –≤–≤–µ–¥–∏—Ç–µ ID –∫–ª—é—á–∞
     - **Team ID**: –≤–≤–µ–¥–∏—Ç–µ –≤–∞—à Apple Team ID

### 3.2 –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞: APNs Certificate
–ï—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç–µ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç –≤–º–µ—Å—Ç–æ –∫–ª—é—á–∞:
1. –°–æ–∑–¥–∞–π—Ç–µ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç –≤ Apple Developer Portal
2. –≠–∫—Å–ø–æ—Ä—Ç–∏—Ä—É–π—Ç–µ –∫–∞–∫ `.p12` —Ñ–∞–π–ª
3. –ó–∞–≥—Ä—É–∑–∏—Ç–µ –≤ Firebase Console

## ‚úÖ –®–∞–≥ 4: –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏

### 4.1 –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ñ–∞–π–ª—ã –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏

**Android** (`src-capacitor/android/app/google-services.json`):
```json
{
  "project_info": {
    "project_id": "comguestspotapp",
    "project_number": "693188820206"
  },
  "client": [{
    "client_info": {
      "android_client_info": {
        "package_name": "com.guestspot.app"
      }
    }
  }]
}
```

**iOS** (`src-capacitor/ios/App/App/GoogleService-Info.plist`):
- `PROJECT_ID`: `comguestspotapp`
- `BUNDLE_ID`: `com.guestspot.app`
- `GCM_SENDER_ID`: `693188820206`

### 4.2 –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è –≤ AndroidManifest.xml
–£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –µ—Å—Ç—å —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ:
```xml
<uses-permission android:name="android.permission.POST_NOTIFICATIONS" />
```

## üß™ –®–∞–≥ 5: –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### 5.1 –¢–µ—Å—Ç–æ–≤–∞—è –æ—Ç–ø—Ä–∞–≤–∫–∞ —á–µ—Ä–µ–∑ Firebase Console
1. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ **Cloud Messaging** ‚Üí **Send your first message**
2. –í–≤–µ–¥–∏—Ç–µ:
   - **Notification title**: "Test Notification"
   - **Notification text**: "This is a test"
3. –ù–∞–∂–º–∏—Ç–µ **Send test message**
4. –í–≤–µ–¥–∏—Ç–µ **FCM registration token** –≤–∞—à–µ–≥–æ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞
5. –ù–∞–∂–º–∏—Ç–µ **Test**

### 5.2 –ö–∞–∫ –ø–æ–ª—É—á–∏—Ç—å FCM token
1. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –Ω–∞ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–µ
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –≤ –∫–æ–Ω—Å–æ–ª–∏ —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞:
   - –î–æ–ª–∂–Ω–æ –±—ã—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ: `Push notification token registered`
   - –¢–æ–∫–µ–Ω –±—É–¥–µ—Ç –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω –Ω–∞ –±—ç–∫–µ–Ω–¥ —á–µ—Ä–µ–∑ `/api/device-tokens`
3. –ò–ª–∏ –¥–æ–±–∞–≤—å—Ç–µ –≤—Ä–µ–º–µ–Ω–Ω—ã–π –ª–æ–≥ –≤ `usePushNotifications.ts`:
   ```typescript
   PushNotifications.addListener('registration', (token: Token) => {
     console.log('FCM Token:', token.value);
   });
   ```

### 5.3 –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç—ã –Ω–∞ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–µ
1. **Android**:
   - –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ –Ω–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω–æ
   - –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –∫–∞–Ω–∞–ª `guestspot-default` —Å–æ–∑–¥–∞–Ω
   - –û—Ç–ø—Ä–∞–≤—å—Ç–µ —Ç–µ—Å—Ç–æ–≤–æ–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ

2. **iOS**:
   - –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ –Ω–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω–æ
   - –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ APNs –Ω–∞—Å—Ç—Ä–æ–µ–Ω
   - –û—Ç–ø—Ä–∞–≤—å—Ç–µ —Ç–µ—Å—Ç–æ–≤–æ–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ

## üîê –®–∞–≥ 6: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –±—ç–∫–µ–Ω–¥–∞

### 6.1 –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ Server Key
```javascript
// –ü—Ä–∏–º–µ—Ä –æ—Ç–ø—Ä–∞–≤–∫–∏ —á–µ—Ä–µ–∑ HTTP API
const response = await fetch('https://fcm.googleapis.com/fcm/send', {
  method: 'POST',
  headers: {
    'Authorization': `key=YOUR_SERVER_KEY`,
    'Content-Type': 'application/json'
  },
  body: JSON.stringify({
    to: 'DEVICE_FCM_TOKEN',
    notification: {
      title: 'Notification Title',
      body: 'Notification Body'
    }
  })
});
```

### 6.2 –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ Service Account (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)
```javascript
// Node.js —Å firebase-admin
const admin = require('firebase-admin');
const serviceAccount = require('./path/to/serviceAccountKey.json');

admin.initializeApp({
  credential: admin.credential.cert(serviceAccount)
});

const message = {
  notification: {
    title: 'Notification Title',
    body: 'Notification Body'
  },
  token: 'DEVICE_FCM_TOKEN'
};

admin.messaging().send(message);
```

## üìù –ß–µ–∫–ª–∏—Å—Ç –Ω–∞—Å—Ç—Ä–æ–π–∫–∏

- [ ] Android –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–æ –≤ Firebase
- [ ] iOS –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–æ –≤ Firebase
- [ ] Cloud Messaging API –≤–∫–ª—é—á–µ–Ω
- [ ] Server Key –∏–ª–∏ Service Account –ø–æ–ª—É—á–µ–Ω
- [ ] APNs –∫–ª—é—á/—Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç –∑–∞–≥—Ä—É–∂–µ–Ω –¥–ª—è iOS
- [ ] `google-services.json` –æ–±–Ω–æ–≤–ª–µ–Ω –¥–ª—è Android
- [ ] `GoogleService-Info.plist` –æ–±–Ω–æ–≤–ª–µ–Ω –¥–ª—è iOS
- [ ] –†–∞–∑—Ä–µ—à–µ–Ω–∏–µ `POST_NOTIFICATIONS` –¥–æ–±–∞–≤–ª–µ–Ω–æ –≤ AndroidManifest.xml
- [ ] –¢–µ—Å—Ç–æ–≤–æ–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ —É—Å–ø–µ—à–Ω–æ

## üö® –ß–∞—Å—Ç—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

### –ü—Ä–æ–±–ª–µ–º–∞: –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –Ω–µ –ø—Ä–∏—Ö–æ–¥—è—Ç –Ω–∞ Android
**–†–µ—à–µ–Ω–∏–µ**:
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω–æ (Android 13+)
2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –∫–∞–Ω–∞–ª —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π —Å–æ–∑–¥–∞–Ω
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏: `adb logcat | grep -i firebase`

### –ü—Ä–æ–±–ª–µ–º–∞: –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –Ω–µ –ø—Ä–∏—Ö–æ–¥—è—Ç –Ω–∞ iOS
**–†–µ—à–µ–Ω–∏–µ**:
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ APNs –Ω–∞—Å—Ç—Ä–æ–µ–Ω –≤ Firebase Console
2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π Bundle ID
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ –Ω–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω–æ
4. –î–ª—è production –Ω—É–∂–µ–Ω production APNs —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç/–∫–ª—é—á

### –ü—Ä–æ–±–ª–µ–º–∞: Token –Ω–µ —Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–µ—Ç—Å—è
**–†–µ—à–µ–Ω–∏–µ**:
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ Firebase –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω –≤ `MainActivity` (Android)
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ Firebase –Ω–∞—Å—Ç—Ä–æ–µ–Ω –≤ `AppDelegate` (iOS)
3. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ `google-services.json` / `GoogleService-Info.plist` –∞–∫—Ç—É–∞–ª—å–Ω—ã

## üìö –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã

- [Firebase Cloud Messaging Documentation](https://firebase.google.com/docs/cloud-messaging)
- [Capacitor Push Notifications Plugin](https://capacitorjs.com/docs/apis/push-notifications)
- [Android Notification Channels](https://developer.android.com/develop/ui/views/notifications/channels)
